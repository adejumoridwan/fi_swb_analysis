---
title: "Data Cleaning"
author: "Adejumo  Ridwan Suleiman"
format: html
---

```{r}
library(tidyverse)
library(haven)
library(psych)
library(mice)
library(FactoMineR)
library(mice)
library(factoextra)
```

```{r}
mics <- read_csv("datasets/mics_imputed.csv")
skimr::skim(mics)
```

```{r}
columns_to_exclude = c("HH1", "HH2", "wmweight", "PSU", "stratum")

mics <- mics %>%
  mutate(across(-all_of(columns_to_exclude), as.ordered))
```

```{r}
skimr::skim(mics)
```
```{r}
head(mics)
```
```{r}

# Load necessary library
library(FactoMineR)

apply_mca <- function(data, n_components = 2, score_names = NULL) {
  # Apply MCA
  mca_result <- MCA(data, graph = FALSE)
  
  # Get the component scores
  scores <- mca_result$ind$coord[, 1:n_components]
  
  # Rename the columns if names are provided
  if (!is.null(score_names)) {
    if (length(score_names) != n_components) {
      stop("Length of score_names must match the number of components.")
    }
    colnames(scores) <- score_names
  } else {
    colnames(scores) <- paste0("Component_", 1:n_components)
  }
  
  data = as_tibble((list(mca_result = mca_result, scores = scores))$scores)
  return(data)
}


```



```{r}

subset = mics |> 
  select(FN1A:FN5)

# Apply MCA
mca_results <- apply_mca(subset, n_components = 2, score_names = c("Comp1", "Comp2"))



mca_results


```

```{r}
# Assuming your data is in a data frame called 'my_data'
mca_result <- MCA(subset, graph = FALSE)
fviz_screeplot(mca_result)
```

